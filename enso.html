<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聖嬰現象視覺化互動教學</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        /* --- Material Design 3 系統色與基礎設定 --- */
        :root {
            --transition-speed: 0.7s; /* 調整為較慢的速度，讓視覺變化更清楚 */

            /* 預設 (正常年 - 綠色調) */
            --md-sys-color-primary: #4CAF50;
            --md-sys-color-on-primary: #ffffff;
            --md-sys-color-primary-container: #C8E6C9;
            --md-sys-color-background: #F5FBF5;
            --md-sys-color-surface: #ffffff;
            --md-sys-color-surface-variant: #E8F5E9;
            --md-sys-color-on-surface-variant: #1B5E20;
            --warm-water-color: rgba(76, 175, 80, 0.6); /* 暖水顏色帶綠 */
            --cold-water-color: #1A237E;
        }

        /* 聖嬰年 (紅色調) */
        body.mode-el-nino {
            --md-sys-color-primary: #D32F2F;
            --md-sys-color-on-primary: #ffffff;
            --md-sys-color-primary-container: #FFCDD2;
            --md-sys-color-background: #FFF8F8;
            --md-sys-color-surface-variant: #FFEBEE;
            --md-sys-color-on-surface-variant: #B71C1C;
            --warm-water-color: rgba(211, 47, 47, 0.7); /* 暖水顏色變紅且更深 */
        }

        /* 反聖嬰年 (藍色調) */
        body.mode-la-nina {
            --md-sys-color-primary: #1976D2;
            --md-sys-color-on-primary: #ffffff;
            --md-sys-color-primary-container: #BBDEFB;
            --md-sys-color-background: #F5F9FF;
            --md-sys-color-surface-variant: #E3F2FD;
            --md-sys-color-on-surface-variant: #0D47A1;
            --warm-water-color: rgba(25, 118, 210, 0.5); /* 暖水顏色變藍 */
        }

        body {
            font-family: 'Roboto', 'Noto Sans TC', sans-serif;
            background-color: var(--md-sys-color-background);
            color: #1c1b1f;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background-color var(--transition-speed);
            box-sizing: border-box;
        }

        /* --- 導航控制區 --- */
        header {
            text-align: center;
            max-width: 800px;
            margin-bottom: 30px;
        }

        h1 {
            margin: 0.5em 0;
            font-weight: 500;
            color: var(--md-sys-color-on-surface-variant);
        }
        
        .controls {
            display: inline-flex;
            background: var(--md-sys-color-surface-variant);
            padding: 4px;
            border-radius: 50px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .pill-btn {
            background: transparent;
            border: none;
            color: var(--md-sys-color-on-surface-variant);
            padding: 10px 20px;
            border-radius: 40px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .pill-btn.active {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* =========================================
           核心視覺化區域 (The Visualization Stage)
        ========================================= */
        .visual-container {
            width: 100%;
            max-width: 900px;
            height: 320px;
            background: linear-gradient(to bottom, #B3E5FC 0%, #E1F5FE 30%, #ffffff 30%);
            border-radius: 28px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 40px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        /* 地理標籤 */
        .geo-label {
            position: absolute;
            top: 10px;
            font-weight: bold;
            font-size: 0.9rem;
            color: #546E7A;
            z-index: 5;
        }
        .label-west { left: 20px; }
        .label-east { right: 20px; text-align: right; }

        /* 陸地 */
        .land {
            position: absolute;
            bottom: 0;
            height: 220px; /* 與海洋同高 */
            width: 60px;
            background-color: #795548;
            z-index: 3;
        }
        .land-west { left: 0; border-radius: 0 12px 0 28px; }
        .land-east { right: 0; border-radius: 12px 0 28px 0; }

        /* --- 海洋部分 --- */
        .ocean-container {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 220px;
            z-index: 1;
        }

        /* 深層冷水 (背景層) */
        .deep-water {
            width: 100%;
            height: 100%;
            background-color: var(--cold-water-color);
            position: absolute;
        }

        /* 表層暖水 (利用 clip-path 切割出斜溫層形狀) */
        .warm-water-layer {
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, var(--warm-water-color), rgba(255,255,255,0.1));
            position: absolute;
            top: 0;
            left: 0;
            transition: clip-path var(--transition-speed) cubic-bezier(0.4, 0.0, 0.2, 1);
            z-index: 2;
        }

        /* --- 大氣與天氣部分 --- */
        /* 風向箭頭容器 */
        .wind-container {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 4;
        }
        
        .wind-arrow {
            font-size: 48px;
            color: var(--md-sys-color-primary);
            opacity: 0.7;
            transition: all var(--transition-speed);
        }

        /* 降雨雲層 */
        .rain-cloud-group {
            position: absolute;
            top: 30px;
            /* 初始位置在西邊 */
            left: 15%; 
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: left var(--transition-speed) cubic-bezier(0.4, 0.0, 0.2, 1);
            z-index: 5;
        }
        .cloud-icon {
            font-size: 64px;
            color: #90A4AE;
        }
        .rain-drops {
            font-size: 32px;
            color: #4FC3F7;
            margin-top: -15px;
            opacity: 0; /* 預設不下的雨，特定模式才下 */
            transition: opacity var(--transition-speed);
        }


        /* =========================================
           各模式的視覺狀態定義 (CSS State Definitions)
        ========================================= */

        /* 1. 正常年 (Normal) */
        body.mode-normal .warm-water-layer {
            /* 左厚右薄，標準斜坡 */
            clip-path: polygon(0 0, 100% 0, 100% 20%, 0 70%);
        }
        body.mode-normal .wind-arrow {
            transform: scaleX(-1); /* 箭頭向左 (東風) */
        }
        body.mode-normal .rain-drops {
            opacity: 1; /* 西邊下雨 */
        }

        /* 2. 聖嬰年 (El Niño) */
        body.mode-el-nino .warm-water-layer {
            /* 變平坦，暖水向東擴展，東側變厚 */
            clip-path: polygon(0 0, 100% 0, 100% 60%, 0 65%);
        }
        body.mode-el-nino .wind-arrow {
            /* 箭頭向右 (西風) 或變很弱顯示為圓點，這裡用向右表示反轉 */
            transform: scaleX(1); 
            opacity: 0.4; /* 風變弱 */
        }
        body.mode-el-nino .rain-cloud-group {
            left: 60%; /* 雲層移往中東太平洋 */
        }
        body.mode-el-nino .rain-drops {
            opacity: 1; /* 東邊下雨 */
        }

        /* 3. 反聖嬰年 (La Niña) */
        body.mode-la-nina .warm-water-layer {
            /* 斜坡變得更陡峭，東側暖水極薄 */
            clip-path: polygon(0 0, 100% 0, 100% 5%, 0 80%);
        }
        body.mode-la-nina .wind-arrow {
            transform: scaleX(-1) scaleY(1.3); /* 強烈的東風 */
            font-weight: bold;
        }
        body.mode-la-nina .rain-cloud-group {
            left: 10%; /* 雲層更往西邊擠 */
        }
        body.mode-la-nina .rain-drops {
            opacity: 1; /* 西邊下大雨 */
        }
        body.mode-la-nina .cloud-icon {
             color: #546E7A; /* 雲變深色表示暴雨 */
        }


        /* --- 底部資料卡片區 (保持原樣，稍作樣式調整以配合新主題) --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            max-width: 900px;
            width: 100%;
        }

        .card {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface-variant);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(0,0,0,0.03);
        }
        .card-label { font-size: 0.8rem; opacity: 0.8; margin-bottom: 8px; display: flex; align-items: center; gap: 5px;}
        .card-value { font-size: 1.1rem; font-weight: 500; line-height: 1.4; }
        .highlight { color: var(--md-sys-color-primary); font-weight: bold; }
        
        /* 響應式調整 */
        @media (max-width: 600px) {
            .visual-container { height: 250px; }
            .land { height: 160px; width: 40px; }
            .ocean-container { height: 160px; }
            .wind-arrow { font-size: 36px; }
            .cloud-icon { font-size: 48px; }
            .pill-btn { padding: 8px 16px; font-size: 0.85rem; }
        }
    </style>
</head>
<body class="mode-normal">

    <header>
        <h1>聖嬰與反聖嬰現象：視覺化互動</h1>
        
        <div class="controls">
            <button class="pill-btn" onclick="setMode('elNino')">聖嬰年 (El Niño)</button>
            <button class="pill-btn active" onclick="setMode('normal')">正常年 (Normal)</button>
            <button class="pill-btn" onclick="setMode('laNina')">反聖嬰年 (La Niña)</button>
        </div>
    </header>

    <div class="visual-container">
        <div class="geo-label label-west">西太平洋<br>(印尼/澳洲)</div>
        <div class="geo-label label-east">東太平洋<br>(南美洲)</div>

        <div class="wind-container">
            <span class="material-icons-round wind-arrow">arrow_right_alt</span>
            <span class="material-icons-round wind-arrow" style="animation-delay: 0.1s">arrow_right_alt</span>
            <span class="material-icons-round wind-arrow" style="animation-delay: 0.2s">arrow_right_alt</span>
        </div>

        <div class="rain-cloud-group">
            <span class="material-icons-round cloud-icon">cloud</span>
            <span class="material-icons-round rain-drops">grain</span>
        </div>

        <div class="land land-west"></div>
        <div class="land land-east"></div>
        
        <div class="ocean-container">
            <div class="deep-water"></div>
            <div class="warm-water-layer"></div>
        </div>
    </div>
    <main class="grid-container" id="contentGrid">
        </main>

    <script>
        // 資料內容 (保持不變)
        const data = {
            elNino: {
                wind: "減弱 (甚至轉為西風)",
                temp: "赤道太平洋中、東部<span class='highlight'>偏高</span>",
                upwelling: "南美沿岸湧升流<span class='highlight'>明顯減弱</span>",
                thermocline: "東太平洋變深 (坡度變平)",
                pressure: "東低西高，循環減弱",
                rain: "赤道東太平洋多雨；印尼/澳洲<span class='highlight'>乾旱</span>",
                ecology: "東太平洋漁獲下降"
            },
            normal: {
                wind: "正常 (強勁東風/信風)",
                temp: "西部暖，東部冷",
                upwelling: "南美沿岸湧升流旺盛",
                thermocline: "西深東淺 (坡度陡)",
                pressure: "東高西低，循環強",
                rain: "西太平洋多雨，東部較乾",
                ecology: "生產力、漁獲正常"
            },
            laNina: {
                wind: "<span class='highlight'>增強</span> (風吹得更猛烈)",
                temp: "西部異常暖，東部<span class='highlight'>異常冷</span>",
                upwelling: "湧升流<span class='highlight'>更強</span>",
                thermocline: "坡度更陡 (東部極淺)",
                pressure: "東更高西更低，循環更強",
                rain: "西太平洋<span class='highlight'>暴雨</span>；東太平洋極度乾燥",
                ecology: "東太平洋漁獲<span class='highlight'>極佳</span>"
            }
        };

        // 精簡了部分標籤，讓畫面更清爽
        const labels = {
            wind: {text: "東風 (信風)", icon: "air"},
            temp: {text: "表層海溫分佈", icon: "thermostat"},
            thermocline: {text: "斜溫層深度", icon: "show_chart"},
            upwelling: {text: "湧升流狀態", icon: "waves"},
            rain: {text: "降雨分佈", icon: "thunderstorm"},
            ecology: {text: "生態與漁業", icon: "set_meal"}
        };

        let currentMode = 'normal';

        function renderCards() {
            const grid = document.getElementById('contentGrid');
            grid.innerHTML = '';
            for (const [key, labelObj] of Object.entries(labels)) {
                const card = document.createElement('div');
                card.className = 'card';
                // 增加 Icon 讓卡片更生動
                card.innerHTML = `
                    <div class="card-label">
                        <span class="material-icons-round" style="font-size:1.2rem">${labelObj.icon}</span>
                        ${labelObj.text}
                    </div>
                    <div class="card-value" id="val-${key}">${data[currentMode][key]}</div>
                `;
                grid.appendChild(card);
            }
        }

        function setMode(mode) {
            currentMode = mode;
            const body = document.body;
            const buttons = document.querySelectorAll('.pill-btn');

            // 1. 更新按鈕狀態
            buttons.forEach((btn, index) => {
                btn.classList.remove('active');
                if (mode === 'elNino' && index === 0) btn.classList.add('active');
                if (mode === 'normal' && index === 1) btn.classList.add('active');
                if (mode === 'laNina' && index === 2) btn.classList.add('active');
            });

            // 2. 更新 Body Class (這會觸發所有 CSS 動畫：顏色、海洋形狀、雲的位置)
            body.className = ''; 
            body.classList.add('mode-' + fixModeName(mode));

            // 3. 更新文字卡片內容
            for (const [key, labelObj] of Object.entries(labels)) {
                 const el = document.getElementById(`val-${key}`);
                 if(el) el.innerHTML = data[mode][key];
            }
        }
        
        // 輔助函式：處理 class 名稱格式
        function fixModeName(name) {
             return name.replace(/([A-Z])/g, "-$1").toLowerCase();
        }

        // 初始化
        renderCards();
    </script>
</body>
</html>